loki:
  fullnameOverride: "loki"

  deploymentMode: SingleBinary

  backend:
    replicas: 0
  read:
    replicas: 0
  write:
    replicas: 0
  gateway:
    enabled: false
  lokiCanary:
    enabled: false
  test:
    enabled: false

  podSecurityContext:
    fsGroup: 10001
    runAsGroup: 10001
    runAsNonRoot: true
    runAsUser: 10001

  containerSecurityContext:
    readOnlyRootFilesystem: true
    capabilities:
      drop: ["ALL"]
    allowPrivilegeEscalation: false

  singleBinary:
    replicas: 1

    resources:
      requests:
        cpu: 100m
        memory: 256Mi
      limits:
        cpu: 500m
        memory: 512Mi

    persistence:
      enabled: true
      size: 1Gi

  loki:
    auth_enabled: false

    server:
      http_listen_port: 3100
      grpc_listen_port: 9095

    commonConfig:
      replication_factor: 1
      ring:
        kvstore:
          store: memberlist

    memberlistConfig:
      join_members: []
      abort_if_cluster_join_fails: false
      bind_port: 7946

    schemaConfig:
      configs:
        - from: 2024-01-01
          store: tsdb
          object_store: filesystem
          schema: v13
          index:
            prefix: index_
            period: 24h

    storage:
      type: filesystem
      filesystem:
        chunks_directory: /var/loki/chunks
        rules_directory: /var/loki/rules

    limits_config:
      max_cache_freshness_per_query: 10m
      split_queries_by_interval: 15m
      max_query_parallelism: 32
      max_entries_limit_per_query: 5000
      per_stream_rate_limit: 5MB
      per_stream_rate_limit_burst: 20MB
      ingestion_rate_mb: 10
      ingestion_burst_size_mb: 20

    validation:
      enforce_metric_name: false
      reject_old_samples: true
      reject_old_samples_max_age: 168h
      max_label_value_length: 20480
      max_label_name_length: 1024
      max_label_names_per_series: 30

    query_range:
      align_queries_with_step: true
      cache_results: false
      max_retries: 5

    frontend:
      log_queries_longer_than: 0s
      compress_responses: true

    analytics:
      reporting_enabled: false

  monitoring:
    serviceMonitor:
      enabled: true
      interval: 30s
      labels:
        release: prometheus

    selfMonitoring:
      enabled: false
      grafanaAgent:
        installOperator: false
